<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Proje DetayÄ± - ADM Ä°nÅŸaat Proje YÃ¶netim Sistemi</title>
  <link rel="stylesheet" href="css/style.css">
  <!-- SheetJS for Excel Import/Export -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
</head>
<body>
  <div class="dashboard-layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <img src="assets/adm_logo.png" alt="ADM Studio" class="sidebar-logo" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
        <h1 style="display: none;">ğŸ—ï¸ ADM Ä°nÅŸaat</h1>
      </div>
      
      <nav class="sidebar-nav">
        <a href="dashboard.html" class="nav-item">
          <span class="nav-icon">ğŸ“Š</span>
          <span class="nav-text">Ana Sayfa</span>
        </a>
        <a href="dashboard.html#projects" class="nav-item">
          <span class="nav-icon">ğŸ—ï¸</span>
          <span class="nav-text">Projeler</span>
        </a>
        
        <!-- Project Specific Navigation -->
        <div style="margin-top: 1.5rem; padding: 0 1rem; color: var(--text-secondary); font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;">
          Proje MenÃ¼sÃ¼
        </div>
        <a href="#" class="nav-item active" data-tab="overview" onclick="switchProjectTab('overview')">
          <span class="nav-icon">ğŸ“Š</span>
          <span class="nav-text">Proje Ã–zeti</span>
        </a>
        <a href="#" class="nav-item" data-tab="logs" onclick="switchProjectTab('logs')">
          <span class="nav-icon">ğŸ“</span>
          <span class="nav-text">Åantiye GÃ¼nlÃ¼ÄŸÃ¼</span>
        </a>
        <a href="#" class="nav-item" data-tab="stocks" onclick="switchProjectTab('stocks')">
          <span class="nav-icon">ğŸ“¦</span>
          <span class="nav-text">Stok YÃ¶netimi</span>
        </a>
        <a href="#" class="nav-item" data-tab="payments" onclick="switchProjectTab('payments')">
          <span class="nav-icon">ğŸ’°</span>
          <span class="nav-text">HakediÅŸ Takibi</span>
        </a>
        <a href="#" class="nav-item" data-tab="budget" onclick="switchProjectTab('budget')">
          <span class="nav-icon">ğŸ’¼</span>
          <span class="nav-text">BÃ¼tÃ§e YÃ¶netimi</span>
        </a>
      </nav>
      
      <div class="sidebar-footer">
        <div class="user-info">
          <div class="user-avatar">ğŸ‘¤</div>
          <div class="user-details">
            <div class="user-name" id="sidebarUserName">YÃ¼kleniyor...</div>
            <div class="user-role" id="sidebarUserRole">...</div>
          </div>
        </div>
        <div class="sidebar-actions">
          <button id="sidebarThemeToggle" class="theme-toggle-btn" onclick="toggleTheme()">
            <div class="theme-option light-option">
              <span class="theme-circle">âšª</span>
              <span class="theme-label">Light</span>
            </div>
            <div class="theme-option dark-option active">
              <span class="theme-circle">âš«</span>
              <span class="theme-label">Dark</span>
            </div>
          </button>
          <button id="logoutBtn" class="logout-btn" onclick="handleLogout()">Ã‡Ä±kÄ±ÅŸ Yap</button>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Top Bar with Breadcrumb -->
      <div class="topbar">
        <div style="display: flex; align-items: center; gap: 1rem; flex: 1;">
          <button class="menu-toggle" id="menuToggle">â˜°</button>
          <div style="display: flex; align-items: center; gap: 0.5rem; color: var(--text-secondary); font-size: 0.9rem;">
            <a href="dashboard.html" style="color: var(--text-secondary); text-decoration: none;">Dashboard</a>
            <span>â€º</span>
            <a href="dashboard.html#projects" style="color: var(--text-secondary); text-decoration: none;">Projeler</a>
            <span>â€º</span>
            <span id="projectNameBreadcrumb" style="color: var(--brand-red); font-weight: 600;">YÃ¼kleniyor...</span>
          </div>
        </div>
        <div class="topbar-actions">
          <span id="userNameDisplay" class="topbar-user"></span>
        </div>
      </div>

      <div id="alertContainer"></div>

      <!-- Project Header -->
      <section class="content-section">
        <div style="background: linear-gradient(135deg, var(--brand-red) 0%, var(--brand-red-dark) 100%); color: white; padding: 1rem 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
          <div style="display: flex; justify-content: space-between; align-items: center; gap: 1.5rem; flex-wrap: wrap;">
            <div style="flex: 1;">
              <h2 id="projectName" style="margin: 0; font-size: 1.5rem;">YÃ¼kleniyor...</h2>
            </div>
            <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
              <button class="btn" style="background: rgba(255,255,255,0.2); color: white; border: 2px solid white; padding: 0.5rem 1rem; font-size: 0.9rem;" onclick="window.location.href='dashboard.html#projects'">
                â† Projelere DÃ¶n
              </button>
              <button id="editProjectBtn" class="btn" style="background: white; color: var(--brand-red); padding: 0.5rem 1rem; font-size: 0.9rem;" onclick="openEditProjectModal()">
                âœï¸ DÃ¼zenle
              </button>
            </div>
          </div>
        </div>

        <!-- Tab Content -->
        <!-- Overview Tab -->
        <div id="overview-tab" class="tab-content">
          <div class="section-header">
            <h3>ğŸ“Š Proje Ã–zeti</h3>
          </div>
          
          <!-- Project Stats Cards -->
          <div class="dashboard-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); margin-bottom: 1.5rem;" id="projectStatsCards">
            <!-- Stats will be loaded dynamically -->
          </div>
          
          <!-- Project Info Card -->
          <div class="card" style="margin-bottom: 1.5rem;">
            <h3 style="margin-bottom: 1rem; color: var(--brand-red);">â„¹ï¸ Proje Bilgileri</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
              <div>
                <label style="display: block; font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Proje AdÄ±</label>
                <div id="overviewProjectName" style="font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">-</div>
              </div>
              <div>
                <label style="display: block; font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">MÃ¼ÅŸteri/Firma</label>
                <div id="overviewCompany" style="font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">-</div>
              </div>
              <div>
                <label style="display: block; font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Durum</label>
                <div id="overviewStatus" style="font-size: 1.1rem; font-weight: 600;">-</div>
              </div>
              <div>
                <label style="display: block; font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">BaÅŸlangÄ±Ã§ Tarihi</label>
                <div id="overviewStartDate" style="font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">-</div>
              </div>
              <div>
                <label style="display: block; font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">BitiÅŸ Tarihi</label>
                <div id="overviewEndDate" style="font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">-</div>
              </div>
              <div>
                <label style="display: block; font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Konum</label>
                <div id="overviewLocation" style="font-size: 1.1rem; font-weight: 600; color: var(--text-primary);">-</div>
              </div>
            </div>
            <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);">
              <label style="display: block; font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">AÃ§Ä±klama</label>
              <div id="overviewDescription" style="line-height: 1.6; color: var(--text-primary);">-</div>
            </div>
          </div>

          <!-- Quick Stats -->
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
            <div class="card" style="text-align: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
              <div style="font-size: 0.85rem; margin-bottom: 0.5rem; opacity: 0.9;">Toplam GÃ¼nlÃ¼k KayÄ±t</div>
              <div id="overviewLogsCount" style="font-size: 2rem; font-weight: bold;">0</div>
            </div>
            <div class="card" style="text-align: center; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
              <div style="font-size: 0.85rem; margin-bottom: 0.5rem; opacity: 0.9;">Toplam Stok Kalemi</div>
              <div id="overviewStocksCount" style="font-size: 2rem; font-weight: bold;">0</div>
            </div>
            <div class="card" style="text-align: center; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white;">
              <div style="font-size: 0.85rem; margin-bottom: 0.5rem; opacity: 0.9;">Toplam HakediÅŸ</div>
              <div id="overviewPaymentsCount" style="font-size: 2rem; font-weight: bold;">0</div>
            </div>
            <div class="card" style="text-align: center; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white;">
              <div style="font-size: 0.85rem; margin-bottom: 0.5rem; opacity: 0.9;">BÃ¼tÃ§e KullanÄ±mÄ±</div>
              <div id="overviewBudgetUsage" style="font-size: 2rem; font-weight: bold;">0%</div>
            </div>
          </div>

          <!-- Quick Actions -->
          <div class="card">
            <h3 style="margin-bottom: 1rem; color: var(--brand-red);">âš¡ HÄ±zlÄ± Ä°ÅŸlemler</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
              <button class="btn btn-primary" onclick="openAddLogModal()" style="padding: 1rem;">
                ğŸ“ GÃ¼nlÃ¼k Ekle
              </button>
              <button class="btn btn-primary" onclick="openAddStockModal()" style="padding: 1rem;">
                ğŸ“¦ Stok Ekle
              </button>
              <button class="btn btn-primary" onclick="openAddPaymentModal()" style="padding: 1rem;">
                ğŸ’° HakediÅŸ Ekle
              </button>
              <button class="btn btn-primary" onclick="openBudgetModalFromProject()" style="padding: 1rem;">
                ğŸ’¼ BÃ¼tÃ§e YÃ¶netimi
              </button>
            </div>
          </div>
        </div>

        <!-- Logs Tab -->
        <div id="logs-tab" class="tab-content hidden">
          <div class="section-header">
            <h3>ğŸ“ Åantiye GÃ¼nlÃ¼ÄŸÃ¼</h3>
            <button class="btn btn-primary" onclick="openAddLogModal()">+ GÃ¼nlÃ¼k Ekle</button>
          </div>
          <div id="logsList" style="margin-top: 1rem;">
            <!-- Logs will be loaded here -->
          </div>
        </div>

        <!-- Stocks Tab -->
        <div id="stocks-tab" class="tab-content hidden">
          <div class="section-header">
            <h3>ğŸ“¦ Stok YÃ¶netimi</h3>
            <button class="btn btn-primary" onclick="openAddStockModal()">+ Stok Ekle</button>
          </div>
          <div id="stocksList" style="margin-top: 1rem;">
            <!-- Stocks will be loaded here -->
          </div>
        </div>

        <!-- Payments Tab -->
        <div id="payments-tab" class="tab-content hidden">
          <div class="section-header">
            <h3>ğŸ’° HakediÅŸ Takibi</h3>
            <button class="btn btn-primary" onclick="openAddPaymentModal()">+ HakediÅŸ Ekle</button>
          </div>
          <div id="paymentsList" style="margin-top: 1rem;">
            <!-- Payments will be loaded here -->
          </div>
        </div>

        <!-- Budget Tab -->
        <div id="budget-tab" class="tab-content hidden">
          <div class="section-header">
            <h3>ğŸ’¼ BÃ¼tÃ§e YÃ¶netimi</h3>
            <button class="btn btn-primary" onclick="openUnifiedBudgetModal()">âš™ï¸ DetaylÄ± BÃ¼tÃ§e YÃ¶netimi</button>
          </div>
          <div id="budgetContent" style="margin-top: 1.5rem;">
            <!-- Budget Summary Cards -->
            <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; margin-bottom: 1.5rem;">
              <h3 style="color: white; margin-bottom: 1rem;">ğŸ“Š BÃ¼tÃ§e Ã–zeti</h3>
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <div style="background: rgba(255,255,255,0.15); padding: 1rem; border-radius: 8px;">
                  <div style="font-size: 0.85rem; margin-bottom: 0.5rem; opacity: 0.9;">Toplam Proje BÃ¼tÃ§esi</div>
                  <div style="font-size: 1.8rem; font-weight: bold;" id="budgetTabTotal">â‚º0</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 1rem; border-radius: 8px;">
                  <div style="font-size: 0.85rem; margin-bottom: 0.5rem; opacity: 0.9;">Toplam Harcama</div>
                  <div style="font-size: 1.8rem; font-weight: bold;" id="budgetTabSpent">â‚º0</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 1rem; border-radius: 8px;">
                  <div style="font-size: 0.85rem; margin-bottom: 0.5rem; opacity: 0.9;">Kalan BÃ¼tÃ§e</div>
                  <div style="font-size: 1.8rem; font-weight: bold;" id="budgetTabRemaining">â‚º0</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 1rem; border-radius: 8px;">
                  <div style="font-size: 0.85rem; margin-bottom: 0.5rem; opacity: 0.9;">KullanÄ±m OranÄ±</div>
                  <div style="font-size: 1.8rem; font-weight: bold;" id="budgetTabPercentage">0%</div>
                </div>
              </div>
              <div style="margin-top: 1rem; background: rgba(255,255,255,0.1); padding: 0.5rem; border-radius: 8px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem; font-size: 0.9rem;">
                  <span>BÃ¼tÃ§e KullanÄ±mÄ±</span>
                  <span id="budgetTabProgressLabel">0%</span>
                </div>
                <div style="background: rgba(255,255,255,0.2); height: 12px; border-radius: 6px; overflow: hidden;">
                  <div id="budgetTabProgressBar" style="background: #4caf50; height: 100%; width: 0%; transition: width 0.5s, background 0.3s;"></div>
                </div>
              </div>
            </div>

            <!-- Quick Actions -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
              <div class="card" style="text-align: center; cursor: pointer; transition: transform 0.2s;" onclick="openCategoriesView()">
                <div style="font-size: 3rem; margin-bottom: 0.5rem;">ğŸ“</div>
                <h4 style="margin-bottom: 0.5rem; color: var(--brand-red);">Kategoriler</h4>
                <p style="font-size: 0.85rem; color: var(--text-secondary); margin: 0;">BÃ¼tÃ§e kategorilerini yÃ¶net</p>
              </div>
              <div class="card" style="text-align: center; cursor: pointer; transition: transform 0.2s;" onclick="openExpensesView()">
                <div style="font-size: 3rem; margin-bottom: 0.5rem;">ğŸ’¸</div>
                <h4 style="margin-bottom: 0.5rem; color: var(--brand-red);">Harcamalar</h4>
                <p style="font-size: 0.85rem; color: var(--text-secondary); margin: 0;">Harcama kayÄ±tlarÄ±nÄ± gÃ¶rÃ¼ntÃ¼le</p>
              </div>
              <div class="card" style="text-align: center; cursor: pointer; transition: transform 0.2s;" onclick="openReportsView()">
                <div style="font-size: 3rem; margin-bottom: 0.5rem;">ğŸ“Š</div>
                <h4 style="margin-bottom: 0.5rem; color: var(--brand-red);">Raporlar</h4>
                <p style="font-size: 0.85rem; color: var(--text-secondary); margin: 0;">DetaylÄ± bÃ¼tÃ§e analizi</p>
              </div>
            </div>

            <!-- Features Info -->
            <div class="card">
              <h3 style="margin-bottom: 1rem; color: var(--brand-red);">ğŸ—ï¸ Ä°nÅŸaat Projeleri Ä°Ã§in BÃ¼tÃ§e YÃ¶netimi</h3>
              <p style="margin-bottom: 1rem; line-height: 1.6; color: var(--text-secondary);">
                <strong>DetaylÄ± BÃ¼tÃ§e YÃ¶netimi</strong> ile projenizdeki tÃ¼m harcamalarÄ± profesyonel ÅŸekilde takip edin.
              </p>
              
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-left: 4px solid #4caf50;">
                  <h4 style="margin-bottom: 0.5rem; color: var(--brand-red);">âœ… 16 Standart Kategori</h4>
                  <p style="font-size: 0.9rem; margin: 0; color: var(--text-secondary);">
                    Ä°ÅŸÃ§ilik, Malzeme, Nakliye, Makine-Ekipman, Elektrik, Tesisat, AltyapÄ±, DÄ±ÅŸ Cephe, Ä°Ã§ Mekan, DoÄŸrama, Ã‡atÄ±, YalÄ±tÄ±m, Peyzaj, Ruhsat, Genel Giderler
                  </p>
                </div>
                <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-left: 4px solid #2196F3;">
                  <h4 style="margin-bottom: 0.5rem; color: var(--brand-red);">ğŸ“ˆ Otomatik Hesaplama</h4>
                  <p style="font-size: 0.9rem; margin: 0; color: var(--text-secondary);">
                    Stok maliyetleri, hakediÅŸ Ã¶demeleri ve bÃ¼tÃ§e harcamalarÄ± otomatik olarak toplanÄ±r ve kalan bÃ¼tÃ§e hesaplanÄ±r
                  </p>
                </div>
                <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-left: 4px solid #ff9800;">
                  <h4 style="margin-bottom: 0.5rem; color: var(--brand-red);">ğŸ¯ Kategori BazlÄ± Takip</h4>
                  <p style="font-size: 0.9rem; margin: 0; color: var(--text-secondary);">
                    Her kategoriye ayrÄ± bÃ¼tÃ§e tahsis edin, harcamalarÄ± kategorilere gÃ¶re izleyin, kullanÄ±m oranlarÄ±nÄ± gÃ¶rÃ¼ntÃ¼leyin
                  </p>
                </div>
                <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-left: 4px solid #9c27b0;">
                  <h4 style="margin-bottom: 0.5rem; color: var(--brand-red);">ğŸ“ DetaylÄ± KayÄ±tlar</h4>
                  <p style="font-size: 0.9rem; margin: 0; color: var(--text-secondary);">
                    Her harcama iÃ§in tarih, aÃ§Ä±klama, kategori ve notlar ekleyin. TÃ¼m harcama geÃ§miÅŸinizi gÃ¶rÃ¼ntÃ¼leyin
                  </p>
                </div>
                <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-left: 4px solid #f44336;">
                  <h4 style="margin-bottom: 0.5rem; color: var(--brand-red);">âš ï¸ UyarÄ± Sistemi</h4>
                  <p style="font-size: 0.9rem; margin: 0; color: var(--text-secondary);">
                    BÃ¼tÃ§e %80'i aÅŸtÄ±ÄŸÄ±nda sarÄ±, %100'Ã¼ aÅŸtÄ±ÄŸÄ±nda kÄ±rmÄ±zÄ± renk uyarÄ±sÄ± ile anlÄ±k bildirim
                  </p>
                </div>
                <div style="background: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-left: 4px solid #00bcd4;">
                  <h4 style="margin-bottom: 0.5rem; color: var(--brand-red);">ğŸ“Š GÃ¶rsel Raporlar</h4>
                  <p style="font-size: 0.9rem; margin: 0; color: var(--text-secondary);">
                    Ä°lerleme Ã§ubuklarÄ±, yÃ¼zdelik grafikler ve renk kodlu kartlar ile kolay takip
                  </p>
                </div>
              </div>

              <button class="btn btn-primary" onclick="openCategoriesView()" style="width: 100%; padding: 1.2rem; font-size: 1.1rem; font-weight: 600;">
                ğŸ“ BÃ¼tÃ§e Kategorilerini YÃ¶net
              </button>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Modals (Same as dashboard.html) -->
  
  <!-- Add Log Modal -->
  <div id="addLogModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Åantiye GÃ¼nlÃ¼ÄŸÃ¼ Ekle</h2>
        <button class="modal-close" onclick="closeAddLogModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="addLogForm" onsubmit="handleAddLog(event)">
          <div class="form-group">
            <label for="logDate">Tarih *</label>
            <input type="date" id="logDate" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary);">
          </div>
          <div class="form-group">
            <label for="logPerformedBy">Yapan KiÅŸi *</label>
            <input type="text" id="logPerformedBy" placeholder="Ä°ÅŸÃ§i/Ekip adÄ±" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary);">
          </div>
          <div class="form-group">
            <label for="logDescription">YapÄ±lan Ä°ÅŸ / AÃ§Ä±klama *</label>
            <textarea id="logDescription" placeholder="Ã–rn: Temel kazÄ±sÄ± tamamlandÄ±, beton dÃ¶kÃ¼mÃ¼ yapÄ±ldÄ±..." required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary); min-height: 120px; resize: vertical;"></textarea>
          </div>
          <div class="form-group">
            <label for="logPhoto">FotoÄŸraf (Opsiyonel)</label>
            <input type="file" id="logPhoto" accept="image/*" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary);">
            <small style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.5rem; display: block;">Max 32MB - ImgBB Ã¼zerinden yÃ¼klenecek</small>
          </div>
          <div style="display: flex; gap: 0.75rem; margin-top: 1.5rem;">
            <button type="submit" class="btn btn-primary" style="flex: 1;">ğŸ’¾ Kaydet</button>
            <button type="button" class="btn btn-secondary" onclick="closeAddLogModal()" style="flex: 1;">âŒ Ä°ptal</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Add Stock Modal -->
  <div id="addStockModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Stok Ekle</h2>
        <button class="modal-close" onclick="closeAddStockModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="addStockForm" onsubmit="handleAddStock(event)">
          <div class="form-group">
            <label for="stockName">ÃœrÃ¼n AdÄ± *</label>
            <input type="text" id="stockName" placeholder="Ã–rn: Ã‡imento, Demir, Kum..." required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary);">
          </div>
          <div class="form-group">
            <label for="stockUnit">Birim *</label>
            <select id="stockUnit" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary);">
              <option value="">SeÃ§iniz</option>
              <option value="Adet">Adet</option>
              <option value="Kg">Kilogram (Kg)</option>
              <option value="Ton">Ton</option>
              <option value="M">Metre (M)</option>
              <option value="M2">Metrekare (MÂ²)</option>
              <option value="M3">MetrekÃ¼p (MÂ³)</option>
              <option value="Lt">Litre (Lt)</option>
              <option value="Paket">Paket</option>
              <option value="Koli">Koli</option>
            </select>
          </div>
          <div class="form-group">
            <label for="stockQuantity">Miktar *</label>
            <input type="number" id="stockQuantity" placeholder="0" min="0" step="0.01" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary);">
          </div>
          <div class="form-group">
            <label for="stockUnitPrice">Birim Fiyat (â‚º) *</label>
            <input type="number" id="stockUnitPrice" placeholder="0.00" min="0" step="0.01" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary);">
          </div>
          <div style="background: var(--bg-tertiary); padding: 1rem; border-radius: 8px; margin-top: 1rem;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <span style="color: var(--text-secondary);">Toplam Tutar:</span>
              <strong id="stockTotalPrice" style="color: var(--brand-red); font-size: 1.25rem;">â‚º0.00</strong>
            </div>
          </div>
          <div style="display: flex; gap: 0.75rem; margin-top: 1.5rem;">
            <button type="submit" class="btn btn-primary" style="flex: 1;">ğŸ’¾ Kaydet</button>
            <button type="button" class="btn btn-secondary" onclick="closeAddStockModal()" style="flex: 1;">âŒ Ä°ptal</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Add Payment Modal -->
  <div id="addPaymentModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>HakediÅŸ Ekle</h2>
        <button class="modal-close" onclick="closeAddPaymentModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="addPaymentForm" onsubmit="handleAddPayment(event)">
          <div class="form-group">
            <label for="paymentDescription">Ä°ÅŸ AÃ§Ä±klamasÄ± *</label>
            <input type="text" id="paymentDescription" placeholder="Ã–rn: Beton dÃ¶kÃ¼mÃ¼, Ã‡elik montajÄ±..." required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary);">
          </div>
          <div class="form-group">
            <label for="paymentPerformedBy">Yapan Firma/KiÅŸi *</label>
            <input type="text" id="paymentPerformedBy" placeholder="Ä°ÅŸi yapan firma veya kiÅŸi" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary);">
          </div>
          <div class="form-group">
            <label for="paymentUnit">Birim *</label>
            <select id="paymentUnit" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary);">
              <option value="">SeÃ§iniz</option>
              <option value="M2">Metrekare (MÂ²)</option>
              <option value="M3">MetrekÃ¼p (MÂ³)</option>
              <option value="M">Metre (M)</option>
              <option value="Adet">Adet</option>
              <option value="Ton">Ton</option>
              <option value="Kg">Kilogram (Kg)</option>
              <option value="GÃ¶rev">GÃ¶rev</option>
              <option value="GÃ¼n">GÃ¼n</option>
            </select>
          </div>
          <div class="form-group">
            <label for="paymentQuantity">Miktar *</label>
            <input type="number" id="paymentQuantity" placeholder="0" min="0" step="0.01" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary);">
          </div>
          <div class="form-group">
            <label for="paymentUnitPrice">Birim Fiyat (â‚º) *</label>
            <input type="number" id="paymentUnitPrice" placeholder="0.00" min="0" step="0.01" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-primary);">
          </div>
          <div style="background: var(--bg-tertiary); padding: 1rem; border-radius: 8px; margin-top: 1rem;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <span style="color: var(--text-secondary);">Toplam HakediÅŸ:</span>
              <strong id="paymentTotalPrice" style="color: var(--brand-red); font-size: 1.25rem;">â‚º0.00</strong>
            </div>
          </div>
          <div style="display: flex; gap: 0.75rem; margin-top: 1.5rem;">
            <button type="submit" class="btn btn-primary" style="flex: 1;">ğŸ’¾ Kaydet</button>
            <button type="button" class="btn btn-secondary" onclick="closeAddPaymentModal()" style="flex: 1;">âŒ Ä°ptal</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Budget Categories Modal -->
  <div id="budgetCategoriesModal" class="modal">
    <div class="modal-content" style="max-width: 900px;">
      <div class="modal-header">
        <h2>ğŸ“ BÃ¼tÃ§e Kategorileri</h2>
        <button class="modal-close" onclick="closeBudgetCategoriesModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
          <p style="margin: 0; color: var(--text-secondary);">Proje iÃ§in tanÄ±mlanmÄ±ÅŸ bÃ¼tÃ§e kategorilerini yÃ¶netin</p>
          <button class="btn btn-primary" onclick="openAddCategoryModal()">â• Kategori Ekle</button>
        </div>
        <div id="budgetCategoriesList" style="max-height: 600px; overflow-y: auto;">
          <!-- Categories will be loaded here -->
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeBudgetCategoriesModal()">Kapat</button>
      </div>
    </div>
  </div>

  <!-- Budget Expenses Modal -->
  <div id="budgetExpensesModal" class="modal">
    <div class="modal-content" style="max-width: 1000px;">
      <div class="modal-header">
        <h2>ğŸ’¸ Harcama KayÄ±tlarÄ±</h2>
        <button class="modal-close" onclick="closeBudgetExpensesModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
          <p style="margin: 0; color: var(--text-secondary);">Proje harcamalarÄ±nÄ± kategorilere gÃ¶re takip edin</p>
          <button class="btn btn-primary" onclick="openAddExpenseModal()">â• Harcama Ekle</button>
        </div>
        <div id="budgetExpensesList" style="max-height: 600px; overflow-y: auto;">
          <!-- Expenses will be loaded here -->
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeBudgetExpensesModal()">Kapat</button>
      </div>
    </div>
  </div>

  <!-- Budget Reports Modal -->
  <div id="budgetReportsModal" class="modal">
    <div class="modal-content" style="max-width: 1200px;">
      <div class="modal-header">
        <h2>ğŸ“Š BÃ¼tÃ§e RaporlarÄ±</h2>
        <button class="modal-close" onclick="closeBudgetReportsModal()">&times;</button>
      </div>
      <div class="modal-body">
        <!-- Budget Summary -->
        <div class="card" style="margin-bottom: 1.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
          <h3 style="margin-bottom: 1rem; color: white;">ğŸ“Š Genel BÃ¼tÃ§e Ã–zeti</h3>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
              <div style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 0.5rem;">Toplam BÃ¼tÃ§e</div>
              <div style="font-size: 1.5rem; font-weight: bold;">â‚º<span id="budgetSummaryTotal">0</span></div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
              <div style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 0.5rem;">BÃ¼tÃ§e HarcamalarÄ±</div>
              <div style="font-size: 1.5rem; font-weight: bold;">â‚º<span id="budgetSummaryExpenses">0</span></div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
              <div style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 0.5rem;">Stok Maliyeti</div>
              <div style="font-size: 1.5rem; font-weight: bold;">â‚º<span id="budgetSummaryStocks">0</span></div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
              <div style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 0.5rem;">HakediÅŸ Ã–demeleri</div>
              <div style="font-size: 1.5rem; font-weight: bold;">â‚º<span id="budgetSummaryPayments">0</span></div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
              <div style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 0.5rem;">Toplam Harcama</div>
              <div style="font-size: 1.5rem; font-weight: bold;">â‚º<span id="budgetSummaryGrandTotal">0</span></div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
              <div style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 0.5rem;">Kalan BÃ¼tÃ§e</div>
              <div style="font-size: 1.5rem; font-weight: bold;" id="budgetSummaryRemaining">â‚º0</div>
            </div>
          </div>
          <div style="margin-top: 1.5rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <span style="font-weight: 600;">BÃ¼tÃ§e KullanÄ±m OranÄ±</span>
              <span style="font-weight: bold; font-size: 1.2rem;" id="budgetSummaryPercentage">0%</span>
            </div>
            <div style="background: rgba(255,255,255,0.2); height: 20px; border-radius: 10px; overflow: hidden;">
              <div id="budgetProgressBar" style="background: #4caf50; height: 100%; width: 0%; transition: width 0.5s, background 0.3s;"></div>
            </div>
          </div>
        </div>

        <!-- Category-wise breakdown -->
        <div class="card">
          <h3 style="margin-bottom: 1rem; color: var(--brand-red);">ğŸ“ˆ Kategoriye GÃ¶re Harcamalar</h3>
          <div id="categoryBreakdown" style="max-height: 400px; overflow-y: auto;">
            <!-- Category breakdown will be loaded here -->
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeBudgetReportsModal()">Kapat</button>
      </div>
    </div>
  </div>

  <!-- Unified Budget Management Modal -->
  <div id="unifiedBudgetModal" class="modal">
    <div class="modal-content" style="max-width: 1400px; max-height: 90vh; overflow-y: auto;">
      <div class="modal-header">
        <h2>ğŸ’° DetaylÄ± BÃ¼tÃ§e YÃ¶netimi</h2>
        <button class="modal-close" onclick="closeUnifiedBudgetModal()">&times;</button>
      </div>
      <div class="modal-body">
        <!-- Budget Summary -->
        <div class="card" style="margin-bottom: 1.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
          <h3 style="margin-bottom: 1rem; color: white;">ğŸ“Š Genel BÃ¼tÃ§e Ã–zeti</h3>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
              <div style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 0.5rem;">Toplam BÃ¼tÃ§e</div>
              <div style="font-size: 1.5rem; font-weight: bold;">â‚º<span id="unifiedBudgetSummaryTotal">0</span></div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
              <div style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 0.5rem;">BÃ¼tÃ§e HarcamalarÄ±</div>
              <div style="font-size: 1.5rem; font-weight: bold;">â‚º<span id="unifiedBudgetSummaryExpenses">0</span></div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
              <div style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 0.5rem;">Stok Maliyeti</div>
              <div style="font-size: 1.5rem; font-weight: bold;">â‚º<span id="unifiedBudgetSummaryStocks">0</span></div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
              <div style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 0.5rem;">HakediÅŸ Ã–demeleri</div>
              <div style="font-size: 1.5rem; font-weight: bold;">â‚º<span id="unifiedBudgetSummaryPayments">0</span></div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
              <div style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 0.5rem;">Toplam Harcama</div>
              <div style="font-size: 1.5rem; font-weight: bold;">â‚º<span id="unifiedBudgetSummaryGrandTotal">0</span></div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px;">
              <div style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 0.5rem;">Kalan BÃ¼tÃ§e</div>
              <div style="font-size: 1.5rem; font-weight: bold;" id="unifiedBudgetSummaryRemaining">â‚º0</div>
            </div>
          </div>
          <div style="margin-top: 1.5rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
              <span style="font-weight: 600;">BÃ¼tÃ§e KullanÄ±m OranÄ±</span>
              <span style="font-weight: bold; font-size: 1.2rem;" id="unifiedBudgetSummaryPercentage">0%</span>
            </div>
            <div style="background: rgba(255,255,255,0.2); height: 20px; border-radius: 10px; overflow: hidden;">
              <div id="unifiedBudgetProgressBar" style="background: #4caf50; height: 100%; width: 0%; transition: width 0.5s, background 0.3s;"></div>
            </div>
          </div>
        </div>

        <!-- Categories and Expenses in 2 columns -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
          <!-- Budget Categories -->
          <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
              <h3 style="margin: 0; color: var(--brand-red);">ğŸ“ BÃ¼tÃ§e Kategorileri</h3>
              <button class="btn btn-primary" onclick="openAddCategoryModal()">â• Kategori Ekle</button>
            </div>
            <div id="unifiedBudgetCategoriesList" style="max-height: 500px; overflow-y: auto;">
              <!-- Categories will be loaded here -->
            </div>
          </div>

          <!-- Budget Expenses -->
          <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
              <h3 style="margin: 0; color: var(--brand-red);">ğŸ’¸ Harcama KayÄ±tlarÄ±</h3>
              <button class="btn btn-primary" onclick="openAddExpenseModal()">â• Harcama Ekle</button>
            </div>
            <div id="unifiedBudgetExpensesList" style="max-height: 500px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
              <!-- Expenses will be loaded here -->
            </div>
          </div>
        </div>

        <!-- Category Breakdown -->
        <div class="card">
          <h3 style="margin-bottom: 1rem; color: var(--brand-red);">ğŸ“ˆ Kategoriye GÃ¶re Harcama DetayÄ±</h3>
          <div id="unifiedCategoryBreakdown" style="max-height: 400px; overflow-y: auto;">
            <!-- Category breakdown will be loaded here -->
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeUnifiedBudgetModal()">Kapat</button>
      </div>
    </div>
  </div>

  <!-- Add Category Modal -->
  <div id="addCategoryModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>â• Yeni Kategori Ekle</h2>
        <button class="modal-close" onclick="closeAddCategoryModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="addCategoryForm" onsubmit="addBudgetCategory(event)">
          <div style="margin-bottom: 1rem;">
            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Kategori AdÄ± *</label>
            <input type="text" id="categoryName" required class="form-control" placeholder="Ã–rn: Ä°ÅŸÃ§ilik, Malzeme, Nakliye">
          </div>
          <div style="margin-bottom: 1rem;">
            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Planlanan BÃ¼tÃ§e (â‚º) *</label>
            <input type="number" id="categoryAllocated" step="0.01" required class="form-control" placeholder="0.00">
          </div>
          <div style="margin-bottom: 1rem;">
            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">AÃ§Ä±klama</label>
            <textarea id="categoryDescription" class="form-control" rows="3" placeholder="Bu kategori iÃ§in notlar..."></textarea>
          </div>
          <div style="display: flex; gap: 1rem; justify-content: flex-end;">
            <button type="button" class="btn btn-secondary" onclick="closeAddCategoryModal()">Ä°ptal</button>
            <button type="submit" class="btn btn-primary">ğŸ’¾ Kaydet</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Add Expense Modal -->
  <div id="addExpenseModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ’¸ Yeni Harcama Ekle</h2>
        <button class="modal-close" onclick="closeAddExpenseModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="addExpenseForm" onsubmit="addBudgetExpense(event)">
          <div style="margin-bottom: 1rem;">
            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Kategori *</label>
            <select id="expenseCategory" required class="form-control">
              <option value="">Kategori SeÃ§in</option>
            </select>
          </div>
          <div style="margin-bottom: 1rem;">
            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Harcama AÃ§Ä±klamasÄ± *</label>
            <input type="text" id="expenseDescription" required class="form-control" placeholder="Ã–rn: Ã‡imento alÄ±mÄ±, Ä°ÅŸÃ§i Ã¼creti">
          </div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
            <div>
              <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Tutar (â‚º) *</label>
              <input type="number" id="expenseAmount" step="0.01" required class="form-control" placeholder="0.00">
            </div>
            <div>
              <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Tarih *</label>
              <input type="date" id="expenseDate" required class="form-control">
            </div>
          </div>
          <div style="margin-bottom: 1rem;">
            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Notlar</label>
            <textarea id="expenseNotes" class="form-control" rows="3" placeholder="Ek bilgiler..."></textarea>
          </div>
          <div style="display: flex; gap: 1rem; justify-content: flex-end;">
            <button type="button" class="btn btn-secondary" onclick="closeAddExpenseModal()">Ä°ptal</button>
            <button type="submit" class="btn btn-primary">ğŸ’¾ Kaydet</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Edit Project Modal -->
  <div id="editProjectModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Proje DÃ¼zenle</h2>
        <button class="modal-close" onclick="closeEditProjectModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="editProjectForm" onsubmit="handleUpdateProject(event)">
          <div class="form-group">
            <label for="editProjectName">Proje AdÄ± *</label>
            <input type="text" id="editProjectName" placeholder="Proje adÄ±nÄ± girin" required>
          </div>
          <div class="form-group">
            <label for="editProjectDesc">AÃ§Ä±klama</label>
            <textarea id="editProjectDesc" placeholder="Proje aÃ§Ä±klamasÄ±" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 4px; resize: vertical; height: 100px;"></textarea>
          </div>
          <div class="form-group">
            <label for="editProjectLocation">Konum *</label>
            <input type="text" id="editProjectLocation" placeholder="Proje konumu" required>
          </div>
          <div class="form-group">
            <label for="editProjectStatus">Durum *</label>
            <select id="editProjectStatus" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 4px;">
              <option value="active">Aktif</option>
              <option value="completed">TamamlandÄ±</option>
              <option value="on-hold">Beklemede</option>
            </select>
          </div>
          <button type="submit" class="btn btn-primary">GÃ¼ncelle</button>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeEditProjectModal()">Ä°ptal</button>
      </div>
    </div>
  </div>

  <!-- Firebase Config -->
  <script type="module" src="js/firebase-config.js"></script>
  
  <!-- API Config -->
  <script src="js/api-config.js"></script>
  
  <!-- Auth Module -->
  <script type="module" src="js/auth.js"></script>
  
  <!-- Projects Module -->
  <script type="module" src="js/projects.js"></script>
  
  <!-- Additional Modules -->
  <script type="module" src="js/upload.js"></script>
  <script type="module" src="js/budget.js"></script>
  <script type="module" src="js/excel.js"></script>
  
  <!-- App Initialization -->
  <script type="module" src="js/app.js"></script>

  <!-- Project Detail Specific Scripts -->
  <script type="module" src="js/project-detail.js"></script>

  <script>
    // Mobile menu toggle
    document.getElementById('menuToggle').addEventListener('click', function() {
      document.querySelector('.sidebar').classList.toggle('sidebar-open');
    });

    // Tab switching
    function switchProjectTab(tab) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
      
      // Show selected tab
      document.getElementById(tab + '-tab').classList.remove('hidden');
      
      // Update nav active state
      document.querySelectorAll('.sidebar-nav .nav-item[data-tab]').forEach(item => item.classList.remove('active'));
      document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
      
      // Load data for the selected tab
      if (tab === 'overview' && window.loadProjectOverview) {
        window.loadProjectOverview();
      } else if (tab === 'logs' && window.loadProjectLogs) {
        window.loadProjectLogs();
      } else if (tab === 'stocks' && window.loadProjectStocks) {
        window.loadProjectStocks();
      } else if (tab === 'payments' && window.loadProjectPayments) {
        window.loadProjectPayments();
      } else if (tab === 'budget' && window.loadBudgetTabSummary) {
        window.loadBudgetTabSummary();
      }
    }
    
    // Quick budget view functions
    function openCategoriesView() {
      if (window.openBudgetCategoriesModal) {
        window.openBudgetCategoriesModal();
      }
    }

    function openExpensesView() {
      if (window.openBudgetExpensesModal) {
        window.openBudgetExpensesModal();
      }
    }

    function openReportsView() {
      if (window.openBudgetReportsModal) {
        window.openBudgetReportsModal();
      }
    }

    window.openCategoriesView = openCategoriesView;
    window.openExpensesView = openExpensesView;
    window.openReportsView = openReportsView;
    
    // Auto-calculate totals for stock form
    document.addEventListener('DOMContentLoaded', function() {
      const stockQuantity = document.getElementById('stockQuantity');
      const stockUnitPrice = document.getElementById('stockUnitPrice');
      const stockTotalPrice = document.getElementById('stockTotalPrice');
      
      function updateStockTotal() {
        const quantity = parseFloat(stockQuantity?.value) || 0;
        const unitPrice = parseFloat(stockUnitPrice?.value) || 0;
        const total = quantity * unitPrice;
        if (stockTotalPrice) {
          stockTotalPrice.textContent = 'â‚º' + total.toLocaleString('tr-TR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }
      }
      
      if (stockQuantity) stockQuantity.addEventListener('input', updateStockTotal);
      if (stockUnitPrice) stockUnitPrice.addEventListener('input', updateStockTotal);
      
      // Auto-calculate totals for payment form
      const paymentQuantity = document.getElementById('paymentQuantity');
      const paymentUnitPrice = document.getElementById('paymentUnitPrice');
      const paymentTotalPrice = document.getElementById('paymentTotalPrice');
      
      function updatePaymentTotal() {
        const quantity = parseFloat(paymentQuantity?.value) || 0;
        const unitPrice = parseFloat(paymentUnitPrice?.value) || 0;
        const total = quantity * unitPrice;
        if (paymentTotalPrice) {
          paymentTotalPrice.textContent = 'â‚º' + total.toLocaleString('tr-TR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }
      }
      
      if (paymentQuantity) paymentQuantity.addEventListener('input', updatePaymentTotal);
      if (paymentUnitPrice) paymentUnitPrice.addEventListener('input', updatePaymentTotal);
      
      // Set default date for log form
      const logDate = document.getElementById('logDate');
      if (logDate) {
        logDate.valueAsDate = new Date();
      }
    });
    
    // Export to window
    window.switchProjectTab = switchProjectTab;
  </script>
</body>
</html>
